{
  "name": "Real-Time Infrastructure Drift & Runtime Enforcement Engine",
  "nodes": [
    {
      "id": "kisumu-vpc",
      "label": "Lake Victoria/Kisumu Regional VPC",
      "subtitle": "10.100.0.0/16",
      "icon": "/icons/aws/network/vpc.png",
      "type": "container",
      "x": 0,
      "y": 0,
      "width": 420,
      "height": 300
    },
    {
      "id": "standard-vpc",
      "label": "Standard VPC",
      "subtitle": "10.0.0.0/16",
      "icon": "/icons/aws/network/vpc.png",
      "type": "container",
      "x": 520,
      "y": 0,
      "width": 420,
      "height": 300
    },
    {
      "id": "eks-cluster",
      "label": "EKS Security Cluster",
      "subtitle": "security-drift-engine",
      "icon": "/icons/aws/analytics/emr-cluster.png",
      "type": "container",
      "x": 100,
      "y": 400,
      "width": 920,
      "height": 760
    },
    {
      "id": "security-nodes",
      "label": "Security-Optimized Node Group",
      "subtitle": "eBPF-Ready Nodes",
      "icon": "/icons/k8s/compute/ds.png",
      "type": "container",
      "x": 90,
      "y": 90,
      "width": 740,
      "height": 580,
      "parentId": "eks-cluster"
    },
    {
      "id": "cilium",
      "label": "Cilium CNI",
      "subtitle": "kube-proxy replacement",
      "icon": "/icons/k8s/compute/pod.png",
      "x": 90,
      "y": 90,
      "parentId": "security-nodes"
    },
    {
      "id": "tetragon",
      "label": "Tetragon Runtime Security",
      "subtitle": "eBPF-based monitoring",
      "icon": "/icons/k8s/compute/ds.png",
      "x": 310,
      "y": 90,
      "parentId": "security-nodes"
    },
    {
      "id": "fluent-bit",
      "label": "Fluent-bit",
      "subtitle": "Log aggregation",
      "icon": "/icons/k8s/compute/ds.png",
      "x": 530,
      "y": 90,
      "parentId": "security-nodes"
    },
    {
      "id": "app-pods",
      "label": "Application Pods",
      "subtitle": "Monitored workloads",
      "icon": "/icons/k8s/compute/pod.png",
      "x": 90,
      "y": 340,
      "parentId": "security-nodes"
    },
    {
      "id": "quarantined-pods",
      "label": "Quarantined Pods",
      "subtitle": "Isolated workloads",
      "icon": "/icons/k8s/compute/pod.png",
      "x": 310,
      "y": 340,
      "parentId": "security-nodes"
    },
    {
      "id": "aws-services",
      "label": "AWS Services",
      "subtitle": "Supporting Infrastructure",
      "icon": "/icons/aws/aws.png",
      "type": "container",
      "x": 1600,
      "y": 200,
      "width": 520,
      "height": 580
    },
    {
      "id": "drift-lambda",
      "label": "Drift Enforcement Lambda",
      "subtitle": "Auto-remediation engine",
      "icon": "/icons/aws/compute/lambda-function.png",
      "x": 90,
      "y": 90,
      "parentId": "aws-services"
    },
    {
      "id": "test-lambda",
      "label": "Remediation Test Lambda",
      "subtitle": "Testing framework",
      "icon": "/icons/aws/compute/lambda-function.png",
      "x": 310,
      "y": 90,
      "parentId": "aws-services"
    },
    {
      "id": "cloudwatch-logs",
      "label": "CloudWatch Logs",
      "x": 100,
      "y": 1260,
      "subtitle": "Event aggregation",
      "icon": "/icons/aws/management/cloudwatch-logs.png",
      "type": "container",
      "width": 520,
      "height": 490
    },
    {
      "id": "s3-archive",
      "label": "S3 Security Archive",
      "subtitle": "Long-term storage",
      "icon": "/icons/aws/storage/simple-storage-service-s3-bucket.png",
      "x": 90,
      "y": 340,
      "parentId": "aws-services"
    },
    {
      "id": "sns-alerts",
      "label": "SNS Security Alerts",
      "subtitle": "Real-time notifications",
      "icon": "/icons/aws/integration/simple-notification-service-sns-topic.png",
      "x": 310,
      "y": 340,
      "parentId": "aws-services"
    },
    {
      "id": "high-severity-logs",
      "label": "High Severity Events",
      "subtitle": "Critical incidents",
      "icon": "/icons/aws/management/cloudwatch-rule.png",
      "x": 90,
      "y": 90,
      "parentId": "cloudwatch-logs"
    },
    {
      "id": "process-logs",
      "label": "Process Execution",
      "subtitle": "execve monitoring",
      "icon": "/icons/aws/management/cloudwatch-logs.png",
      "x": 310,
      "y": 90,
      "parentId": "cloudwatch-logs"
    },
    {
      "id": "file-logs",
      "label": "File Access Events",
      "x": 90,
      "y": 250,
      "subtitle": "FIM monitoring",
      "icon": "/icons/aws/management/cloudwatch-logs.png",
      "parentId": "cloudwatch-logs"
    },
    {
      "id": "network-logs",
      "label": "Network Events",
      "x": 310,
      "y": 250,
      "subtitle": "Traffic monitoring",
      "icon": "/icons/aws/management/cloudwatch-logs.png",
      "parentId": "cloudwatch-logs"
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "tetragon",
      "target": "fluent-bit",
      "label": "JSON events",
      "color": "blue"
    },
    {
      "id": "e2",
      "source": "fluent-bit",
      "target": "cloudwatch-logs",
      "label": "structured logs",
      "color": "blue"
    },
    {
      "id": "e3",
      "source": "high-severity-logs",
      "target": "drift-lambda",
      "label": "real-time trigger",
      "color": "red"
    },
    {
      "id": "e4",
      "source": "drift-lambda",
      "target": "quarantined-pods",
      "label": "NetworkPolicy isolation",
      "color": "red"
    },
    {
      "id": "e5",
      "source": "drift-lambda",
      "target": "sns-alerts",
      "label": "security alerts",
      "color": "red"
    },
    {
      "id": "e6",
      "source": "fluent-bit",
      "target": "s3-archive",
      "label": "compliance archive",
      "color": "green"
    },
    {
      "id": "e7",
      "source": "test-lambda",
      "target": "drift-lambda",
      "label": "test scenarios",
      "style": "dashed"
    },
    {
      "id": "e8",
      "source": "cilium",
      "target": "tetragon",
      "label": "eBPF integration"
    },
    {
      "id": "e9",
      "source": "app-pods",
      "target": "tetragon",
      "label": "runtime monitoring"
    }
  ],
  "legend": {
    "edges": [
      {
        "label": "Data Flow",
        "color": "blue",
        "style": "solid"
      },
      {
        "label": "Security Enforcement",
        "color": "red",
        "style": "solid"
      },
      {
        "label": "Archival/Compliance",
        "color": "green",
        "style": "solid"
      },
      {
        "label": "Regional Context",
        "color": "purple",
        "style": "solid"
      },
      {
        "label": "Testing/Validation",
        "style": "dashed"
      }
    ]
  }
}